name: Test Trending News Setup

on:
  workflow_dispatch:  # Manual trigger only for testing

permissions:
  contents: write
  actions: read

jobs:
  test-setup:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Test Python setup
      working-directory: ./trending/scripts
      run: |
        echo "🧪 Testing Python setup..."
        python --version
        echo "📁 Current directory: $(pwd)"
        echo "📂 Directory contents:"
        ls -la
        
    - name: Test requirements file
      working-directory: ./trending/scripts
      run: |
        echo "📋 Checking requirements.txt..."
        cat requirements.txt
        echo "📦 Installing basic dependencies for testing..."
        pip install requests beautifulsoup4 feedparser
        
    - name: Run setup test
      working-directory: ./trending/scripts
      run: |
        echo "🧪 Running setup validation..."
        python test_setup.py
        
    - name: Test news generator import
      working-directory: ./trending/scripts
      run: |
        echo "🔍 Testing if news generator can be imported..."
        python -c "
import sys
import os
print('Python path:', sys.path)
try:
    import news_generator
    print('✅ news_generator.py imported successfully')
    print('✅ EnhancedTrendingNewsGenerator class found')
except ImportError as e:
    print('❌ Import error:', e)
except Exception as e:
    print('❌ Other error:', e)
"